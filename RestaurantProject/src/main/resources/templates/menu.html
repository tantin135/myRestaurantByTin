<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" type="text/css" th:href="@{/assets/css/Menu.css}"/>
</head>
<body>
    <!-- Header ch·ª©a c√°c tab lo·∫°i m√≥n -->
    <div class="header">
    	<div class="logo">
                <img src="/assets/img/Logo.png">
            </div>
       <div class="option-bar">
		    <button class="tab-btn" onclick="window.location.href='/menu?type=Dish'">M√≥n ƒÉn</button>
		    <button class="tab-btn" onclick="window.location.href='/menu?type=Drink'">ƒê·ªì u·ªëng</button>
		    <button class="tab-btn" onclick="window.location.href='/menu?type=Combo'">Combo</button>
		    <button class="tab-btn" onclick="window.location.href='/menu'">Menu T·ªïng</button>
		</div>
		
		 <div class="cart-icon">
    		<a href="http://localhost:8080/OrderList" class="cart-button">
      			<button class="cart-btn">
        			<i class="fa-duotone fa-solid fa-cart-plus"></i>
      			</button>
   			 </a>
  		</div>

    </div>

    <!-- Thanh t√¨m ki·∫øm -->
    <div class="search-bar">
        <input type="text" placeholder="Nh·∫≠p M√£/ T√™n m√≥n ƒÉn c·∫ßn t√¨m..." id="search-bar">
        <button class="search-btn">üîç</button>
    </div>

    <!-- Danh s√°ch c√°c m√≥n ƒÉn -->
    <div class="menu-items">
        <!-- D·ªØ li·ªáu ƒë·ªông l·∫•y t·ª´ bi·∫øn Thymeleaf ${menuItems} -->
        <div class="menu-item" th:each="item : ${menuItems}">
            <img th:src="@{${item.imagePath}}" th:alt="${item.dishName}">
            <div class="item-info">
                <h3 th:text="${item.dishName}"></h3>
                <p th:text="${item.price} + ' ƒë'"></p>
                  <form action="/add-to-order" method="post">
                <input type="hidden" name="dishId" th:value="${item.dishId}"> <!-- dishId ƒë·ªông t·ª´ d·ªØ li·ªáu Thymeleaf -->
                <button type="submit" class="heart-btn">
                    <i class="fa-solid fa-heart"></i>
                </button>
            </form>
            </div>
        </div>
        <!-- N·∫øu kh√¥ng c√≥ d·ªØ li·ªáu -->
        <p th:if="${menuItems == null || menuItems.isEmpty()}" style="text-align: center; color: red;">
            Kh√¥ng c√≥ m√≥n ƒÉn n√†o ƒë·ªÉ hi·ªÉn th·ªã.
        </p>
    </div>

    <!-- Script x·ª≠ l√Ω t√¨m ki·∫øm -->
    <script>
        // X·ª≠ l√Ω t√¨m ki·∫øm theo t√™n m√≥n ƒÉn
        const searchBar = document.getElementById('search-bar');
        searchBar.addEventListener('input', () => {
            const query = searchBar.value.toLowerCase();
            const items = document.querySelectorAll('.menu-item');
            items.forEach(item => {
                const name = item.querySelector('h3').textContent.toLowerCase();
                item.style.display = name.includes(query) ? 'block' : 'none';
            });
        });
    </script>
    
    <script>
    function addToOrder(dishId) {
        // G·ª≠i y√™u c·∫ßu AJAX t·ªõi backend ƒë·ªÉ l∆∞u m√≥n ƒÉn v√†o b·∫£ng order
        fetch('/add-to-order', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ dishId: dishId })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('M√≥n ƒÉn ƒë√£ ƒë∆∞·ª£c th√™m v√†o ƒë∆°n h√†ng');
            } else {
                alert('C√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('C√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i');
        });
    }
</script>
</body>
</html>